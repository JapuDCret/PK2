
# ArgusServer REST API

The root URL of our REST API is: `http://{host}/argus/v1/`

The API offers several functions for managing user accounts, requesting live statuses from managed Kiosks and alike



--------------------------------------------------------------------------------
## Authentication

### Register an account

This Endpoint uses the data given by the client to register a user account.

#### Operation

```PUT /auth/account/{username}```

##### Request

|Property|Type|Description|
|--|--|--|
|*username*|string|A username for the account. It has to be 4 to 32 characters long.|
|*password*|string|A password for the account. This must be at least 6 characters long.|

Example query:
```PUT /auth/account/pzwegat```
Request-Body:
```json
{
	"password": "alligator3"
}
```

#### Response

// TODO

### Login

Here the client can log into an account. The server generates a session token that is attached to this request's response.
This Token must be included in all following requests (that require authorization).
To include the Token,	insert it into the HTTP 'Authorization' header in the following format: `Bearer {token}`

Example:

`Authorization: Bearer o980r1asd08zprqlxoj9snlp8aqwl6dn`

#### Operation

```POST /auth/account/{username}/login```

#### Request

|Property|Type|Description|
|--|--|--|
|*username*|string|Username of the account.|
|*password*|string|Password of the account.|

Example query: 
```PUT /auth/account/pzwegat/login```
Request-Body:
```json
{
	"password": "alligator3"
}
```

#### Response

The response is a TokenInfo object with the following properties:

|Property|Type|Description|
|--|--|--|
|*identifier*|String|Unique session token generated by the server. Put this in the HTTP Authorization Header for every following request.|
|*validUntil*|Long|Moment, when the Token becomes invalid, as Unix time (in milliseconds since epoch).|

Example response data:
```json
{
	"identifier": "o980r1asd08zprqlxoj9snlp8aqwl6dn",
	"validUntil": 1530488335000
}
```

### Logout

*Requires authorization! See "Login" for more information.*

This function disables the session token and logs out the user. 

#### Operation

```POST /auth/account/{username}/logout```

#### Request

|Property|Type|Description|
|--|--|--|
|*username*|string|Username of the account.|
|*token*|string|Identifier of a Token.|

Example query: 
```POST /auth/account/pzwegat/logout```
Request-Body:
```json
{
	"token": "o980r1asd08zprqlxoj9snlp8aqwl6dn"
}
```

#### Response

// TODO

### TokenInfo

*Requires authorization! See "Login" for more information.*

This function returns Information about the Token.

#### Operation

```GET /auth/account/{username}/token_info```

#### Response

The response is a TokenInfo object with the following properties:

|Property|Type|Description|
|--|--|--|
|*identifier*|String|Unique session token generated by the server. Put this in the HTTP Authorization Header for every following request.|
|*validUntil*|Long|Moment, when the Token becomes invalid, as Unix time (in milliseconds since epoch).|

Example response data:
```json
{
	"identifier": "o980r1asd08zprqlxoj9snlp8aqwl6dn",
	"validUntil": 1530488335000
}
```

### AccountInfo

// TODO

### edit AccountInfo

// TODO


--------------------------------------------------------------------------------
## Kiosk

### List of Kiosks

*Requires authorization! See "Login" for more information.*

This function	returns a list of all configured Kiosks

#### Operation

```GET /kiosks```

#### Response

The response is a JSON array of KioskPlain objects with the following properties:

|Property|Type|Description|
|--|--|--|
|*kioskId*|Long|Identifier of this Kiosk.|
|*kioskName*|String|Name of this Kiosk.|
|*kioskStatus*|String|The Status of this Kiosk.|
|*kioskLastUpdated*|Long|Last Update Time for the status of this Kiosk as Unix time (in milliseconds since epoch).|
|*airlines*|String[]|Identifiers of Airlines this Kiosk belongs to.|
|*groups*|String[]|Identifiers of Groups this Kiosk belongs to.|
|*parentFolderId*|Long|Identifier of the MAC folder, in which the Kiosk was placed. (null means root-folder)|

Example query: 
```GET /kiosks```
Response-Body:
```json
[
	{
		"kioskId": 1,
		"kioskName": "mac-kiosk-001",
		"kioskStatus": "ONLINE",
		"kioskLastUpdated": 1530488335000,
		"airlines": [ "EZY", "WEST" ],
		"groups": [ "DEFAULT" ],
		"parentFolderId": null
	},
	{
		"kioskId": 3,
		"kioskName": "mac-kiosk-003",
		"kioskStatus": "ONLINE",
		"kioskLastUpdated": 1530488335000,
		"airlines": [ "EZY" ],
		"groups": [ "DEFAULT" ],
		"parentFolderId": null
	}
]
```

### specific Kiosk

*Requires authorization! See "Login" for more information.*

This function returns a specific Kiosk with detailed Information

#### Operation

```GET /kiosks/{kioskId}```

#### Response

The response is a KioskDetailed object with the following properties:

|Property|Type|Description|
|--|--|--|
|*kioskId*|Long|Identifier of the Kiosk.|
|*kioskName*|String|Name of the Kiosk.|
|*kioskStatus*|String|The Status of the Kiosk.|
|*kioskLastUpdated*|Long|Last Update Time for the Status of the Kiosk as Unix time (in milliseconds since epoch).|
|*airlines*|String[]|Identifiers of Airlines this Kiosk belongs to.|
|*groups*|String[]|Identifiers of Groups this Kiosk belongs to.|
|*parentFolderId*|Long|Identifier of the MAC folder, in which the Kiosk was placed. (null means root-folder)|
|*componentsGrouped*|Map<String, Map<String, ComponentType>|A Map which contains the Components of a Kiosk grouped by Type(i.e. PRINTER, APPLICATION, ..). An entry contains itself again a Map, which lists all Components of that specific Type.|

Example query: 
```GET /kiosks/1```
Response-Body:
```json
{
	"kioskId": 1,
	"kioskName": "mac-kiosk-001",
	"kioskStatus": "ONLINE",
	"kioskLastUpdated": 1530488335000,
	"airlines": [ "EZY", "WEST" ],
	"groups": [ "DEFAULT" ],
	"parentFolderId": null,
	"componentsGrouped": {
		"APPLICATION": {
			"EASYJET-APP": {
				"id": "EASYJET-APP",
				"name": "EasyJet Application",
				"type": "APPLICATION",
				"status": "ONLINE",
				"detailedStatus": "ONLINE"
			 },
			"AIRCANADA-APP": {
				"id": "AIRCANADA-APP",
				"name": "AirCanada Application",
				"type": "APPLICATION",
				"status": "OFFLINE",
				"detailedStatus": "TIMEOUT"
			}
		},
		"PLATFORM": {
			"MAT_PLF": {
				"id": "MAT_PLF",
				"name": "Materna Platform 4.xx",
				"type": "PLATFORM",
				"status": "OK",
				"detailedStatus": "OK"
			}
		},
		"PRINTER": {
			"BPP_0": {
				"id": "BPP_0",
				"name": "Fujitsu 9870 GPP",
				"type": "PRINTER",
				"status": "ERROR",
				"detailedStatus": "PAPER_JAM"
			}
		}
	}
}
```


--------------------------------------------------------------------------------
## Commands

### Send System Command

*Requires authorization! See "Login" for more information.*

This function executes a Command on the Operating System of the Kiosk

#### Operation

```POST /commands/SYSTEM```

#### Request

Pass the following properties inside the HTTP-Body of the POST request:

|Property|Type|Description|
|--|--|--|
|*kioskId*|Long|Identifier of a specific Kiosk.|
|*command*|String|The Command that should be executed.|

#### Response

// TODO

Example query: 
```POST /commands/SYSTEM```
Request-Body:
```json
{
	"kioskId": "3",
	"command": "STOP"
}
```

### Send Application Command

*Requires authorization! See "Login" for more information.*

This function executes a Command on an (Airline-) Application, running on the targeted Kiosk

#### Operation

```POST /commands/APPLICATION```

#### Request

Pass the following properties inside the HTTP-Body of the POST request:

|Property|Type|Description|
|--|--|--|
|*kioskId*|Long|Identifier of a specific Kiosk.|
|*applicationId*|String|Identifier of the application on this Kiosk.|
|*command*|String|The Command that should be executed.|

#### Response

// TODO

Example query: 
```POST /commands/APPLICATION```
Request-Body:
```json
{
	"kioskId": "3",
	"applicationId": "EASYJET-APP",
	"command": "STOP"
}
```

### Send Platform Command

*Requires authorization! See "Login" for more information.*

This function executes a Command on a Platform, running on the targeted Kiosk

#### Operation

```POST /commands/PLATFORM```

#### Request

Pass the following properties inside the HTTP-Body of the POST request:

|Property|Type|Description|
|--|--|--|
|*kioskId*|Long|Identifier of a specific Kiosk.|
|*platformId*|String|Identifier of the platform on this Kiosk.|
|*command*|String|The Command that should be executed.|

#### Response

// TODO

Example query: 
```POST /commands/PLATFORM```
Request-Body:
```json
{
	"kioskId": "3",
	"applicationId": "MAT_PLF",
	"command": "STOP"
}
```


--------------------------------------------------------------------------------
## Interventions

Interventions represent situations, where floorwalkers need to take action on a Kiosk, e.g. in a case of Request for Assistance.

### List of Interventions

*Requires authorization! See "Login" for more information.*

This function	returns a list of all valid Interventions

#### Operation

```GET /interventions```

#### Response

The response is a JSON array of InterventionPlain objects with the following properties:

|Property|Type|Description|
|--|--|--|
|*interventionId*|String|Identifier of this Intervention.|
|*kioskId*|Long|Identifier of the associated Kiosk.|
|*title*|String|A short Title to the Intervention.|
|*severity*|String|Severity of this Intervention (e.g. LOW, NORMAL, HIGH, URGENT).|
|*resolved*|Boolean|Displays whether or not this Intervention has been resolved.|
|*asignee*|String|Username of the User that this Intervention has been asigned to.|

Example query: 
```GET /interventions```
Response-Body:
```json
[
	{
		"interventionId": "23fca306-5bb0-4a78-bf06-676b52816cce",
		"kioskId": 3,
		"title": "Kiosk 3 requires assistance",
		"severity": "HIGH",
		"resolved": false,
		"asignee": "pzwegat"
	},
	{
		"interventionId": "72a7c568-00d3-42b7-8298-ded93defaa35",
		"kioskId": 1,
		"title": "Kiosk 1 requires hardware assistance",
		"severity": "URGENT",
		"resolved": true,
		"asignee": "pzwegat"
	}
]
```

### specific Intervention

*Requires authorization! See "Login" for more information.*

This function returns a specific Intervention with detailed Information

#### Operation

```GET /interventions/{interventionId}```

#### Response

The response is a InterventionDetailed object with the following properties:

|Property|Type|Description|
|--|--|--|
|*interventionId*|String|Identifier of this Intervention.|
|*kioskId*|Long|Identifier of the associated Kiosk.|
|*title*|String|A short Title to the Intervention.|
|*severity*|String|Severity of this Intervention (e.g. LOW, NORMAL, HIGH, URGENT).|
|*resolved*|Boolean|Displays whether or not this Intervention has been resolved.|
|*asignee*|String|Username of the User that this Intervention has been asigned to.|
|*asigner*|String|Username of the User that assigned this Intervention to a User.|
|*details*|String|Further details to the Intervention.|
|*additionalInfo*|Map<String, Object>|Map with additional Information (intended for future use).|

Example query: 
```GET /interventions/23fca306-5bb0-4a78-bf06-676b52816cce```
Response-Body:
```json
{
	"interventionId": "23fca306-5bb0-4a78-bf06-676b52816cce",
	"kioskId": 3,
	"title": "Kiosk 3 requires assistance",
	"severity": "HIGH",
	"asignee": "pzwegat",
	"asigner": "admin",
	"details": "Customer at Kiosk 3 reported a mismatch of submitted and displayed bags",
	"additionalInfo": {}
}
```

### edit specific Intervention

*Requires authorization! See "Login" for more information.*

This function edits a specific Intervention

#### Operation

```PUT /interventions/{interventionId}```

#### Request

The properties send via the request are merged with the old state.

The request is an InterventionDetailed object with the following properties:

|Property|Type|Description|
|--|--|--|
|*interventionId*|String|Identifier of this Intervention.|
|*kioskId*|Long|(cannot be modified) Identifier of the associated Kiosk.|
|*title*|String|(Optional) A short Title to the Intervention.|
|*severity*|String|(Optional) Severity of this Intervention (e.g. LOW, NORMAL, HIGH, URGENT).|
|*resolved*|Boolean|(Optional) Displays whether or not this Intervention has been resolved.|
|*asignee*|String|(Optional) Username of the User that this Intervention has been asigned to.|
|*asigner*|String|(cannot be modified) Username of the User that assigned this Intervention to a User.|
|*details*|String|(Optional) Further details to the Intervention.|
|*additionalInfo*|Map<String, Object>|(Optional) Map with additional Information (intended for future use).|

Example query: 
```PUT /interventions/23fca306-5bb0-4a78-bf06-676b52816cce```
Response-Body:
```json
{
	"resolved": "true"
}
```
